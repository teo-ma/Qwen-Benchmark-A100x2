sudo -u azureuser python3 - <<'PY'
from base64 import b64decode
from pathlib import Path

data = """
IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiJVbmlmaWVkIFF3ZW4gYmVu
Y2htYXJrIHJ1bm5lciB3aXRoIG9wdGlvbmFsIE5WTWUgb2ZmbG9hZCBoZWxwZXJzLiIiIgoKZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhbm5vdGF0aW9ucwoKaW1wb3J0IGFyZ3BhcnNlCmltcG9ydCBqc29uCmltcG9ydCBtYXRoCmltcG9ydCBvcwppbXBvcnQgdGltZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdCwgT3B0aW9uYWwsIFR1cGxlLCBVbmlvbgoKaW1wb3J0IHRvcmNoCmZyb20gdHJhbnNmb3JtZXJzIGltcG9ydCBBdXRvTW9kZWxGb3JDYXVzYWxMTSwgQXV0b1Rva2VuaXplciAgIyB0eXBlOiBpZ25vcmUKCnRyeTogICMgYml0c2FuZGJ5dGVzIGlzIG9wdGlvbmFsIG91dHNpZGUgSU5UOCBydW5zCiAgICBmcm9tIHRyYW5zZm9ybWVycyBpbXBvcnQgQml0c0FuZEJ5dGVzQ29uZmlnICAjIHR5cGU6IGlnbm9yZQpleGNlcHQgSW1wb3J0RXJyb3I6ICAjIHByYWdtYTogbm8gY292ZXIgLSBkZXBlbmRlbmN5IG9wdGlvbmFsIG9uIEZQMTYtb25seSBob3N0cwogICAgQml0c0FuZEJ5dGVzQ29uZmlnID0gTm9uZQoKdHJ5OiAgIyB2TExNIGlzIG9wdGlvbmFsIGZvciB0ZW5zb3IgcGFyYWxsZWwgcnVucwogICAgZnJvbSB2bGxtIGltcG9ydCBMTE0sIFNhbXBsaW5nUGFyYW1zICAjIHR5cGU6IGlnbm9yZQpleGNlcHQgSW1wb3J0RXJyb3I6ICAjIHByYWdtYTogbm8gY292ZXIgLSB2TExNIG9ubHkgbmVlZGVkIHdoZW4gZW5naW5lPXZsbG0KICAgIExMTSA9IE5vbmUKICAgIFNhbXBsaW5nUGFyYW1zID0gTm9uZQoKdHJ5OiAgIyBMTURlcGxveSBpcyBvcHRpb25hbCB1bmxlc3MgVHVyYm9NaW5kIGJlbmNobWFya2luZyBpcyByZXF1ZXN0ZWQKICAgIGZyb20gbG1kZXBsb3kgaW1wb3J0IHBpcGVsaW5lIGFzIGxtZGVwbG95X3BpcGVsaW5lICAjIHR5cGU6IGlnbm9yZQogICAgZnJvbSBsbWRlcGxveSBpbXBvcnQgVHVyYm9taW5kRW5naW5lQ29uZmlnICAjIHR5cGU6IGlnbm9yZQpleGNlcHQgSW1wb3J0RXJyb3I6ICAjIHByYWdtYTogbm8gY292ZXIgLSBMTURlcGxveSBvbmx5IG5lZWRlZCBmb3IgVHVyYm9NaW5kIHJ1bnMKICAgIGxtZGVwbG95X3BpcGVsaW5lID0gTm9uZQogICAgVHVyYm9taW5kRW5naW5lQ29uZmlnID0gTm9uZQoKQkFTRV9QUk9NUFQgPSAoCiAgICAiVW5pZmllZCBRd2VuIGJlbmNobWFyayBwYXlsb2FkIG1peGluZyBFbmdsaXNoLCDkuK3mlocsIGFuZCBzdHJ1Y3R1cmVkIHN0ZXBzLiAiCiAgICAiV2Ugc3RyZXNzIHRva2VuaXplciB2YXJpZXR5IHdpdGggbWV0cmljcywgQVBJcywgYW5kIGNvbXBsaWFuY2UgdGV4dC4gIgogICAgIuWGjeWkmuWGmeS4gOS6m+maj+acuueahOivjeivreadpeWinuWKoOWkjeadguW6pi4iCikKCgpkZWYgcHJlcGFyZV9wcm9tcHRfdG9rZW5zKHRva2VuaXplcjogQXV0b1Rva2VuaXplciwgdGFyZ2V0X3Rva2VuczogaW50KSAtPiBUdXBsZVt0b3JjaC5UZW5zb3IsIHRvcmNoLlRlbnNvcl06CiAgICBiYXNlX3Rva2VucyA9IHRva2VuaXplcihCQVNFX1BST01QVCwgcmV0dXJuX3RlbnNvcnM9InB0IiwgYWRkX3NwZWNpYWxfdG9rZW5zPUZhbHNlKVsiaW5wdXRfaWRzIl1bMF0KICAgIGlmIGJhc2VfdG9rZW5zLm5lbGVtZW50KCkgPT0gMDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJQcm9tcHQgdG9rZW5pemVyIHJldHVybmVkIHplcm8gdG9rZW5zIikKICAgIHJlcGVhdHMgPSBtYXRoLmNlaWwoKHRhcmdldF90b2tlbnMgKyBsZW4oYmFzZV90b2tlbnMpIC0gMSkgLyBsZW4oYmFzZV90b2tlbnMpKQogICAgZXhwYW5kZWQgPSBiYXNlX3Rva2Vucy5yZXBlYXQocmVwZWF0cylbOnRhcmdldF90b2tlbnNdCiAgICBpbnB1dF9pZHMgPSBleHBhbmRlZC51bnNxdWVlemUoMCkKICAgIGF0dGVudGlvbl9tYXNrID0gdG9yY2gub25lc19saWtlKGlucHV0X2lkcykKICAgIHJldHVybiBpbnB1dF9pZHMsIGF0dGVudGlvbl9tYXNrCgoKZGVmIHN5bmNfY3VkYSgpIC0+IE5vbmU6CiAgICBpZiB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpOgogICAgICAgIHRvcmNoLmN1ZGEuc3luY2hyb25pemUoKQoKCmRlZiBjb2xsZWN0X3BlYWtfbWVtb3J5KCkgLT4gRGljdFtzdHIsIGZsb2F0XToKICAgIHBlYWtzOiBEaWN0W3N0ciwgZmxvYXRdID0ge30KICAgIGlmIHRvcmNoLmN1ZGEuaXNfYXZhaWxhYmxlKCk6CiAgICAgICAgZm9yIGlkeCBpbiByYW5nZSh0b3JjaC5jdWRhLmRldmljZV9jb3VudCgpKToKICAgICAgICAgICAgYnl0ZXNfdXNlZCA9IHRvcmNoLmN1ZGEubWF4X21lbW9yeV9hbGxvY2F0ZWQoaWR4KQogICAgICAgICAgICBwZWFrc1tmImN1ZGE6e2lkeH0iXSA9IHJvdW5kKGJ5dGVzX3VzZWQgLyAoMTAyNCAqKiAzKSwgMikKICAgIHJldHVybiBwZWFrcwoKCmRlZiBidWlsZF9tYXhfbWVtb3J5KGxpbWl0X2dpYjogT3B0aW9uYWxbZmxvYXRdKSAtPiBPcHRpb25hbFtEaWN0W1VuaW9uW2ludCwgc3RyXSwgc3RyXV06CiAgICBpZiBsaW1pdF9naWIgaXMgTm9uZSBvciBub3QgdG9yY2guY3VkYS5pc19hdmFpbGFibGUoKToKICAgICAgICByZXR1cm4gTm9uZQogICAgcGVyX2RldmljZSA9IGYie2xpbWl0X2dpYn1HaUIiCiAgICBsYXlvdXQ6IERpY3RbVW5pb25baW50LCBzdHJdLCBzdHJdID0ge2lkeDogcGVyX2RldmljZSBmb3IgaWR4IGluIHJhbmdlKHRvcmNoLmN1ZGEuZGV2aWNlX2NvdW50KCkpfQogICAgIyBBbHNvIGFkdmVydGlzZSBhIGdlbmVyb3VzIENQVSBidWRnZXQgc28gYWNjZWxlcmF0ZSBoYXMgcm9vbSB0byBzcGlsbCB0ZW5zb3JzLgogICAgbGF5b3V0WyJjcHUiXSA9ICI1MTJHaUIiCiAgICByZXR1cm4gbGF5b3V0CgoKZGVmIHJ1bl9iZW5jaG1hcmsoCiAgICBtb2RlbF9pZDogc3RyLAogICAgcHJlY2lzaW9uOiBzdHIsCiAgICBwcm9tcHRfdG9rZW5zOiBpbnQsCiAgICBnZW5fdG9rZW5zOiBpbnQsCiAgICBkZXZpY2VfbWFwOiBzdHIsCiAgICBtYXhfbWVtb3J5X2dpYjogT3B0aW9uYWxbZmxvYXRdLAogICAgb2ZmbG9hZF9mb2xkZXI6IE9wdGlvbmFsW3N0cl0sCiAgICBvZmZsb2FkX3N0YXRlX2RpY3Q6IGJvb2wsCiAgICBvZmZsb2FkX2J1ZmZlcnM6IGJvb2wsCiAgICBsb3dfY3B1X21lbV91c2FnZTogYm9vbCwKICAgIGVuZ2luZTogc3RyLAogICAgdGVuc29yX3BhcmFsbGVsX3NpemU6IGludCwKICAgIGF0dG5faW1wbDogc3RyLAogICAgbWF4X21vZGVsX2xlbjogT3B0aW9uYWxbaW50XSwKICAgIGdwdV9tZW1vcnlfdXRpbGl6YXRpb246IGZsb2F0LAogICAgbG1kZXBsb3lfbW9kZWxfcGF0aDogT3B0aW9uYWxbc3RyXSwKKSAtPiBEaWN0W3N0ciwgb2JqZWN0XToKICAgIHRva2VuaXplciA9IEF1dG9Ub2tlbml6ZXIuZnJvbV9wcmV0cmFpbmVkKG1vZGVsX2lkLCB0cnVzdF9yZW1vdGVfY29kZT1UcnVlKQogICAgaWYgdG9rZW5pemVyLnBhZF90b2tlbiBpcyBOb25lOgogICAgICAgIHRva2VuaXplci5wYWRfdG9rZW4gPSB0b2tlbml6ZXIuZW9zX3Rva2VuCgogICAgaW5wdXRfaWRzLCBhdHRlbnRpb25fbWFzayA9IHByZXBhcmVfcHJvbXB0X3Rva2Vucyh0b2tlbml6ZXIsIHByb21wdF90b2tlbnMpCgogICAgaWYgZW5naW5lID09ICJoZiI6CiAgICAgICAgbW9kZWxfa3dhcmdzOiBEaWN0W3N0ciwgb2JqZWN0XSA9IHsKICAgICAgICAgICAgImRldmljZV9tYXAiOiBkZXZpY2VfbWFwLAogICAgICAgICAgICAidHJ1c3RfcmVtb3RlX2NvZGUiOiBUcnVlLAogICAgICAgIH0KCiAgICAgICAgbWF4X21lbW9yeSA9IGJ1aWxkX21heF9tZW1vcnkobWF4X21lbW9yeV9naWIpCiAgICAgICAgaWYgbWF4X21lbW9yeToKICAgICAgICAgICAgbW9kZWxfa3dhcmdzWyJtYXhfbWVtb3J5Il0gPSBtYXhfbWVtb3J5CgogICAgICAgIGlmIG9mZmxvYWRfZm9sZGVyOgogICAgICAgICAgICBtb2RlbF9rd2FyZ3NbIm9mZmxvYWRfZm9sZGVyIl0gPSBvZmZsb2FkX2ZvbGRlcgogICAgICAgIGlmIG9mZmxvYWRfc3RhdGVfZGljdDoKICAgICAgICAgICAgbW9kZWxfa3dhcmdzWyJvZmZsb2FkX3N0YXRlX2RpY3QiXSA9IFRydWUKICAgICAgICBpZiBvZmZsb2FkX2J1ZmZlcnM6CiAgICAgICAgICAgIG1vZGVsX2t3YXJnc1sib2ZmbG9hZF9idWZmZXJzIl0gPSBUcnVlCiAgICAgICAgaWYgbG93X2NwdV9tZW1fdXNhZ2U6CiAgICAgICAgICAgIG1vZGVsX2t3YXJnc1sibG93X2NwdV9tZW1fdXNhZ2UiXSA9IFRydWUKICAgICAgICBpZiBhdHRuX2ltcGwgIT0gImF1dG8iOgogICAgICAgICAgICBtb2RlbF9rd2FyZ3NbImF0dG5faW1wbGVtZW50YXRpb24iXSA9IGF0dG5faW1wbAoKICAgICAgICBpZiBwcmVjaXNpb24ubG93ZXIoKSA9PSAiZnAxNiI6CiAgICAgICAgICAgIG1vZGVsX2t3YXJnc1sidG9yY2hfZHR5cGUiXSA9IHRvcmNoLmZsb2F0MTYKICAgICAgICBlbGlmIHByZWNpc2lvbi5sb3dlcigpID09ICJpbnQ4IjoKICAgICAgICAgICAgaWYgQml0c0FuZEJ5dGVzQ29uZmlnIGlzIE5vbmU6CiAgICAgICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoImJpdHNhbmRieXRlcyBpcyByZXF1aXJlZCBmb3IgSU5UOCBydW5zIikKICAgICAgICAgICAgbW9kZWxfa3dhcmdzWyJxdWFudGl6YXRpb25fY29uZmlnIl0gPSBCaXRzQW5kQnl0ZXNDb25maWcoCiAgICAgICAgICAgICAgICBsb2FkX2luXzhiaXQ9VHJ1ZSwKICAgICAgICAgICAgICAgIGxsbV9pbnQ4X3RocmVzaG9sZD02LjAsCiAgICAgICAgICAgICAgICBsbG1faW50OF9oYXNfZnAxNl93ZWlnaHQ9RmFsc2UsCiAgICAgICAgICAgICAgICBsbG1faW50OF9lbmFibGVfZnAzMl9jcHVfb2ZmbG9hZD1GYWxzZSwKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZiJVbnN1cHBvcnRlZCBwcmVjaXNpb246IHtwcmVjaXNpb259IikKCiAgICAgICAgaWYgdG9yY2guY3VkYS5pc19hdmFpbGFibGUoKToKICAgICAgICAgICAgdG9yY2guY3VkYS5lbXB0eV9jYWNoZSgpCiAgICAgICAgICAgIHRvcmNoLmN1ZGEucmVzZXRfcGVha19tZW1vcnlfc3RhdHMoKQoKICAgICAgICBtb2RlbCA9IEF1dG9Nb2RlbEZvckNhdXNhbExNLmZyb21fcHJldHJhaW5lZChtb2RlbF9pZCwgKiptb2RlbF9rd2FyZ3MpCgogICAgICAgIGlucHV0X2lkc19oZiA9IGlucHV0X2lkcy50byhtb2RlbC5kZXZpY2UpCiAgICAgICAgYXR0ZW50aW9uX21hc2tfaGYgPSBhdHRlbnRpb25fbWFzay50byhtb2RlbC5kZXZpY2UpCgogICAgICAgIHN5bmNfY3VkYSgpCiAgICAgICAgc3RhcnQgPSB0aW1lLnBlcmZfY291bnRlcigpCiAgICAgICAgb3V0cHV0cyA9IG1vZGVsLmdlbmVyYXRlKAogICAgICAgICAgICBpbnB1dF9pZHM9aW5wdXRfaWRzX2hmLAogICAgICAgICAgICBhdHRlbnRpb25fbWFzaz1hdHRlbnRpb25fbWFza19oZiwKICAgICAgICAgICAgbWF4X25ld190b2tlbnM9Z2VuX3Rva2VucywKICAgICAgICAgICAgdGVtcGVyYXR1cmU9MC43LAogICAgICAgICAgICB0b3BfcD0wLjksCiAgICAgICAgICAgIGRvX3NhbXBsZT1GYWxzZSwKICAgICAgICApCiAgICAgICAgc3luY19jdWRhKCkKICAgICAgICBlbGFwc2VkID0gdGltZS5wZXJmX2NvdW50ZXIoKSAtIHN0YXJ0CgogICAgICAgIHRvdGFsX3Rva2VucyA9IG91dHB1dHMuc2hhcGVbLTFdCiAgICAgICAgbmV3X3Rva2VucyA9IHRvdGFsX3Rva2VucyAtIHByb21wdF90b2tlbnMKICAgICAgICBleGNlcnB0X3Rva2VucyA9IG91dHB1dHNbMF1bLW1pbihuZXdfdG9rZW5zLCA2NCk6XQogICAgICAgIGV4Y2VycHRfdGV4dCA9IHRva2VuaXplci5kZWNvZGUoZXhjZXJwdF90b2tlbnMsIHNraXBfc3BlY2lhbF90b2tlbnM9VHJ1ZSkuc3RyaXAoKQoKICAgICAgICBkZXZpY2VfbWFwX29iaiA9IGdldGF0dHIobW9kZWwsICJoZl9kZXZpY2VfbWFwIiwgTm9uZSkKICAgICAgICBpZiBpc2luc3RhbmNlKGRldmljZV9tYXBfb2JqLCBkaWN0KToKICAgICAgICAgICAgZGV2aWNlX21hcF9zZXJpYWxpemFibGUgPSB7a2V5OiBzdHIodmFsKSBmb3Iga2V5LCB2YWwgaW4gZGV2aWNlX21hcF9vYmouaXRlbXMoKX0KICAgICAgICBlbHNlOgogICAgICAgICAgICBkZXZpY2VfbWFwX3NlcmlhbGl6YWJsZSA9IE5vbmUKCiAgICAgICAgcGVha19tZW1vcnkgPSBjb2xsZWN0X3BlYWtfbWVtb3J5KCkKICAgICAgICBtYXhfbWVtb3J5X3JlcXVlc3QgPSBtb2RlbF9rd2FyZ3MuZ2V0KCJtYXhfbWVtb3J5IikKCiAgICBlbGlmIGVuZ2luZSA9PSAidmxsbSI6CiAgICAgICAgaWYgcHJlY2lzaW9uLmxvd2VyKCkgIT0gImZwMTYiOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJ2TExNIHBhdGggY3VycmVudGx5IHN1cHBvcnRzIEZQMTYgb25seSBpbiB0aGlzIHNjcmlwdCIpCiAgICAgICAgaWYgTExNIGlzIE5vbmUgb3IgU2FtcGxpbmdQYXJhbXMgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJ2bGxtIHBhY2thZ2UgaXMgcmVxdWlyZWQgd2hlbiAtLWVuZ2luZSB2bGxtIikKCiAgICAgICAgbGxtID0gTExNKAogICAgICAgICAgICBtb2RlbD1tb2RlbF9pZCwKICAgICAgICAgICAgdGVuc29yX3BhcmFsbGVsX3NpemU9dGVuc29yX3BhcmFsbGVsX3NpemUsCiAgICAgICAgICAgIGR0eXBlPSJmbG9hdDE2IiwKICAgICAgICAgICAgdHJ1c3RfcmVtb3RlX2NvZGU9VHJ1ZSwKICAgICAgICAgICAgbWF4X21vZGVsX2xlbj1tYXhfbW9kZWxfbGVuLAogICAgICAgICAgICBncHVfbWVtb3J5X3V0aWxpemF0aW9uPWdwdV9tZW1vcnlfdXRpbGl6YXRpb24sCiAgICAgICAgKQoKICAgICAgICBzYW1wbGluZ19wYXJhbXMgPSBTYW1wbGluZ1BhcmFtcygKICAgICAgICAgICAgdGVtcGVyYXR1cmU9MC43LAogICAgICAgICAgICB0b3BfcD0wLjksCiAgICAgICAgICAgIG1heF90b2tlbnM9Z2VuX3Rva2VucywKICAgICAgICApCgogICAgICAgIHByb21wdF90b2tlbl9pZHM6IExpc3RbaW50XSA9IGlucHV0X2lkc1swXS50b2xpc3QoKQogICAgICAgIHByb21wdF90b2tlbl9iYXRjaDogTGlzdFtMaXN0W2ludF1dID0gW3Byb21wdF90b2tlbl9pZHNdCiAgICAgICAgcHJvbXB0X3RleHRfYmF0Y2g6IExpc3Rbc3RyXSA9IFt0b2tlbml6ZXIuZGVjb2RlKGlucHV0X2lkc1swXSwgc2tpcF9zcGVjaWFsX3Rva2Vucz1UcnVlKV0KCiAgICAgICAgc3luY19jdWRhKCkKICAgICAgICBzdGFydCA9IHRpbWUucGVyZl9jb3VudGVyKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIG91dHB1dHMgPSBsbG0uZ2VuZXJhdGUocHJvbXB0X3Rva2VuX2lkcz1wcm9tcHRfdG9rZW5fYmF0Y2gsIHNhbXBsaW5nX3BhcmFtcz1zYW1wbGluZ19wYXJhbXMpCiAgICAgICAgZXhjZXB0IFR5cGVFcnJvciBhcyBleGM6CiAgICAgICAgICAgIGlmICJwcm9tcHRfdG9rZW5faWRzIiBub3QgaW4gc3RyKGV4Yyk6CiAgICAgICAgICAgICAgICByYWlzZQogICAgICAgICAgICBvdXRwdXRzID0gbGxtLmdlbmVyYXRlKHByb21wdHM9cHJvbXB0X3RleHRfYmF0Y2gsIHNhbXBsaW5nX3BhcmFtcz1zYW1wbGluZ19wYXJhbXMpCiAgICAgICAgc3luY19jdWRhKCkKICAgICAgICBlbGFwc2VkID0gdGltZS5wZXJmX2NvdW50ZXIoKSAtIHN0YXJ0CgogICAgICAgIGlmIG5vdCBvdXRwdXRzOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoInZMTE0gcmV0dXJuZWQgbm8gZ2VuZXJhdGlvbnMiKQoKICAgICAgICBmaXJzdF9vdXRwdXQgPSBvdXRwdXRzWzBdCiAgICAgICAgaWYgbm90IGZpcnN0X291dHB1dC5vdXRwdXRzOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoInZMTE0gcmVzcG9uc2UgbWlzc2luZyBvdXRwdXQgdG9rZW5zIikKCiAgICAgICAgZ2VuZXJhdGVkID0gZmlyc3Rfb3V0cHV0Lm91dHB1dHNbMF0KICAgICAgICBuZXdfdG9rZW5zID0gbGVuKGdlbmVyYXRlZC50b2tlbl9pZHMpCiAgICAgICAgZXhjZXJwdF90ZXh0ID0gZ2VuZXJhdGVkLnRleHQuc3RyaXAoKQogICAgICAgIGRldmljZV9tYXBfc2VyaWFsaXphYmxlID0gewogICAgICAgICAgICAiZW5naW5lIjogInZsbG0iLAogICAgICAgICAgICAidGVuc29yX3BhcmFsbGVsX3NpemUiOiB0ZW5zb3JfcGFyYWxsZWxfc2l6ZSwKICAgICAgICB9CiAgICAgICAgcGVha19tZW1vcnkgPSBjb2xsZWN0X3BlYWtfbWVtb3J5KCkKICAgICAgICBtYXhfbWVtb3J5X3JlcXVlc3QgPSBOb25lCgogICAgZWxpZiBlbmdpbmUgPT0gImxtZGVwbG95IjoKICAgICAgICBpZiBwcmVjaXNpb24ubG93ZXIoKSAhPSAiZnAxNiI6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIkxNRGVwbG95IFR1cmJvTWluZCBwYXRoIGN1cnJlbnRseSBzdXBwb3J0cyBGUDE2IG9ubHkgaW4gdGhpcyBzY3JpcHQiKQogICAgICAgIGlmIGxtZGVwbG95X3BpcGVsaW5lIGlzIE5vbmUgb3IgVHVyYm9taW5kRW5naW5lQ29uZmlnIGlzIE5vbmU6CiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcihibWRlcGxveSBwYWNrYWdlIGlzIHJlcXVpcmVkIHdoZW4gLS1lbmdpbmUgbG1kZXBsb3kpCiAgICAgICAgaWYgbm90IGxtZGVwbG95X21vZGVsX3BhdGg6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoIi0tbG1kZXBsb3ktbW9kZWwtcGF0aCBpcyByZXF1aXJlZCB3aGVuIC0tZW5naW5lIGxtZGVwbG95IikKCiAgICAgICAgc2Vzc2lvbl9sZW4gPSBtYXhfbW9kZWxfbGVuIG9yIChwcm9tcHRfdG9rZW5zICsgZ2VuX3Rva2VucyArIDEwMjQpCiAgICAgICAgY2FjaGVfcmF0aW8gPSBtYXgoMC4xLCBtaW4oZ3B1X21lbW9yeV91dGlsaXphdGlvbiwgMC45NSkpCiAgICAgICAgYmFja2VuZF9jb25maWcgPSBUdXJib21pbmRFbmdpbmVDb25maWcoCiAgICAgICAgICAgIHRwPXRlbnNvcl9wYXJhbGxlbF9zaXplLAogICAgICAgICAgICBzZXNzaW9uX2xlbj1zZXNzaW9uX2xlbiwKICAgICAgICAgICAgY2FjaGVfbWF4X2VudHJ5X2NvdW50PWNhY2hlX3JhdGlvLAogICAgICAgICAgICBtYXhfYmF0Y2hfc2l6ZT0xLAogICAgICAgICkKCiAgICAgICAgaWYgdG9yY2guY3VkYS5pc19hdmFpbGFibGUoKToKICAgICAgICAgICAgdG9yY2guY3VkYS5lbXB0eV9jYWNoZSgpCiAgICAgICAgICAgIHRvcmNoLmN1ZGEucmVzZXRfcGVha19tZW1vcnlfc3RhdHMoKQoKICAgICAgICBwaXBlID0gbG1kZXBsb3lfcGlwZWxpbmUoCiAgICAgICAgICAgIGxtZGVwbG95X21vZGVsX3BhdGgsCiAgICAgICAgICAgIGJhY2tlbmRfY29uZmlnPWJhY2tlbmRfY29uZmlnLAogICAgICAgICkKCiAgICAgICAgcHJvbXB0X3RleHQgPSB0b2tlbml6ZXIuZGVjb2RlKGlucHV0X2lkc1swXSwgc2tpcF9zcGVjaWFsX3Rva2Vucz1UcnVlKQoKICAgICAgICBzeW5jX2N1ZGEoKQogICAgICAgIHN0YXJ0ID0gdGltZS5wZXJmX2NvdW50ZXIoKQogICAgICAgIHJlc3BvbnNlcyA9IHBpcGUoCiAgICAgICAgICAgIFtwcm9tcHRfdGV4dF0sCiAgICAgICAgICAgIG1heF9uZXdfdG9rZW5zPWdlbl90b2tlbnMsCiAgICAgICAgICAgIHRlbXBlcmF0dXJlPTAuNywKICAgICAgICAgICAgdG9wX3A9MC45LAogICAgICAgICkKICAgICAgICBzeW5jX2N1ZGEoKQogICAgICAgIGVsYXBzZWQgPSB0aW1lLnBlcmZfY291bnRlcigpIC0gc3RhcnQKCiAgICAgICAgaWYgbm90IHJlc3BvbnNlcy46CiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiTE1EZXBsb3kgcGlwZWxpbmUgcmV0dXJuZWQgbm8gcmVzcG9uc2VzIikKICAgICAgICBmaXJzdF9yZXNwb25zZSA9IHJlc3BvbnNlc1swXQogICAgICAgIG5ld190b2tlbnMgPSBnZXRhdHRyKGZpcnN0X3Jlc3BvbnNlLCAiZ2VuZXJhdGVfdG9rZW5fbGVuIiwgMCkKICAgICAgICBpZiBub3QgbmV3X3Rva2VucyBhbmQgZ2V0YXR0cihmaXJzdF9yZXNwb25zZSwgInRva2VuX2lkcyIsIE5vbmUpOgogICAgICAgICAgICBuZXdfdG9rZW5zID0gbGVuKGZpcnN0X3Jlc3BvbnNlLnRva2VuX2lkcykKICAgICAgICBpZiBub3QgbmV3X3Rva2VuczoKICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJMTURlcGxveSByZXNwb25zZSBtaXNzaW5nIHRva2VuIHN0YXRpc3RpY3MiKQogICAgICAgIGV4Y2VycHRfdGV4dCA9IHN0cihnZXRhdHRyKGZpcnN0X3Jlc3BvbnNlLCAidGV4dCIsICIiKSkuc3RyaXAoKQogICAgICAgIGRldmljZV9tYXBfc2VyaWFsaXphYmxlID0gewogICAgICAgICAgICAiZW5naW5lIjogImxtZGVwbG95LXR1cmJvbWluZCIsCiAgICAgICAgICAgICJ0ZW5zb3JfcGFyYWxsZWxfc2l6ZSI6IHRlbnNvcl9wYXJhbGxlbF9zaXplLAogICAgICAgICAgICAic2Vzc2lvbl9sZW4iOiBzZXNzaW9uX2xlbiwKICAgICAgICB9CiAgICAgICAgcGVha19tZW1vcnkgPSBjb2xsZWN0X3BlYWtfbWVtb3J5KCkKICAgICAgICBtYXhfbWVtb3J5X3JlcXVlc3QgPSBOb25lCgogICAgZWxzZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiVW5zdXBwb3J0ZWQgZW5naW5lOiB7ZW5naW5lfSIpCgogICAgcmVzdWx0OiBEaWN0W3N0ciwgb2JqZWN0XSA9IHsKICAgICAgICAibW9kZWwiOiBtb2RlbF9pZCwKICAgICAgICAicHJlY2lzaW9uIjogcHJlY2lzaW9uLAogICAgICAgICJwcm9tcHRfdG9rZW5zIjogcHJvbXB0X3Rva2VucywKICAgICAgICAiZ2VuZXJhdGVkX3Rva2VucyI6IG5ld190b2tlbnMsCiAgICAgICAgInJlcXVlc3RlZF9nZW5lcmF0ZWRfdG9rZW5zIjogZ2VuX3Rva2VucywKICAgICAgICAid2FsbF90aW1lX3NlY29uZHMiOiBlbGFwc2VkLAogICAgICAgICJ0b2tlbnNfcGVyX3NlY29uZCI6IG5ld190b2tlbnMgLyBlbGFwc2VkIGlmIGVsYXBzZWQgPiAwIGVsc2UgZmxvYXQoImluZiIpLAogICAgICAgICJleGNlcnB0IjogZXhjZXJwdF90ZXh0LAogICAgICAgICJkZXZpY2VfbWFwIjogZGV2aWNlX21hcF9zZXJpYWxpemFibGUsCiAgICAgICAgInBlYWtfbWVtb3J5X2dpYiI6IHBlYWtfbWVtb3J5LAogICAgICAgICJtYXhfbWVtb3J5X3JlcXVlc3QiOiBtYXhfbWVtb3J5X3JlcXVlc3QsCiAgICAgICAgIm9mZmxvYWRfZm9sZGVyIjogb2ZmbG9hZF9mb2xkZXIsCiAgICAgICAgIm9mZmxvYWRfc3RhdGVfZGljdCI6IG9mZmxvYWRfc3RhdGVfZGljdCwKICAgICAgICAib2ZmbG9hZF9idWZmZXJzIjogb2ZmbG9hZF9idWZmZXJzLAogICAgICAgICJsb3dfY3B1X21lbV91c2FnZSI6IGxvd19jcHVfbWVtX3VzYWdlLAogICAgICAgICJlbmdpbmUiOiBlbmdpbmUsCiAgICAgICAgInRlbnNvcl9wYXJhbGxlbF9zaXplIjogdGVuc29yX3BhcmFsbGVsX3NpemUsCiAgICAgICAgImF0dG5faW1wbGVtZW50YXRpb24iOiBhdHRuX2ltcGwsCiAgICAgICAgIm1heF9tb2RlbF9sZW4iOiBtYXhfbW9kZWxfbGVuLAogICAgICAgICJncHVfbWVtb3J5X3V0aWxpemF0aW9uIjogZ3B1X21lbW9yeV91dGlsaXphdGlvbiwKICAgICAgICAibG1kZXBsb3lfbW9kZWxfcGF0aCI6IGxtZGVwbG95X21vZGVsX3BhdGgsCiAgICB9CiAgICByZXR1cm4gcmVzdWx0CgoKZGVmIG1haW4oKSAtPiBOb25lOgogICAgcGFyc2VyID0gYXJncGFyc2UuQXJndW1lbnRQYXJzZXIoZGVzY3JpcHRpb249IlJ1biBRd2VuIGJlbmNobWFyayBmb3IgYXJiaXRyYXJ5IG1vZGVsIikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tbW9kZWwiLCByZXF1aXJlZD1UcnVlLCBoZWxwPSJNb2RlbCBJRCwgZS5nLiwgUXdlbi9Rd2VuMi41LTMyQi1JbnN0cnVjdCIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXByZWNpc2lvbiIsIGNob2ljZXM9WyJGUDI0IiwgIklOVDgiXSwgcmVxdWlyZWQ9VHJ1ZSkKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tcHJvbXB0LXRva2VucyIsIHR5cGU9aW50LCBkZWZhdWx0PTEwXzAwMCkKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tZ2VuZXJhdGVkLXRva2VucyIsIHR5cGU9aW50LCBkZWZhdWx0PTgwMCkKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tZGV2aWNlLW1hcCIsIGRlZmF1bHQ9ImF1dG8iLCBoZWxwPSJkZXZpY2VfbWFwIHBhc3NlZCB0byBmcm9tX3ByZXRyYWluZWQgKEhGIGVuZ2luZSkiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1tYXgtbWVtb3J5LWdpYiIsIHR5cGU9ZmxvYXQsIGhlbHA9Ik9wdGlvbmFsIHBlci1HUFUgbWVtb3J5IGNhcCBwYXNzZWQgdG8gZnJvbV9wcmV0cmFpbmVkIikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tb2ZmbG9hZC1mb2xkZXIiLCBoZWxwPSJPcHRpb25hbCBvZmZsb2FkIGZvbGRlciBwYXRoIChlLmcuLCBOVk1lIG1vdW50KSIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW9mZmxvYWQtc3RhdGUtZGljdCIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9IkVuYWJsZSBzdGF0ZSBkaWN0IG9mZmxvYWQgdG8gQ1BVL2Rpc2siKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1vZmZsb2FkLWJ1ZmZlcnMiLCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxwPSJFbmFibGUgYnVmZmVyIG9mZmxvYWQgdG8gQ1BVL2Rpc2siKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1sb3ctY3B1LW1lbS11c2FnZSIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9IkFjdGl2YXRlIGxvd19jcHVfbWVtX3VzYWdlIGZsYWciKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgoIi0tZW5naW5lIiwgY2hvaWNlcz1bImhmIiwgInZsbG0iLCAibG1kZXBsb3kiXSwgZGVmYXVsdD0iaGYiLCBoZWxwPSJSdW50aW1lIGVuZ2luZTogSHVnZ2luZ0ZhY2UsIHZMTE0sIG9yIExNRGVwbG95IFR1cmJvTWluZCIpKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS10ZW5zb3ItcGFyYWxsZWwtc2l6ZSIsIHR5cGU9aW50LCBkZWZhdWx0PTEsIGhlbHA9IlRlbnNvciBwYXJhbGxlbCBkZWdyZWUgZm9yIHZMTE0iKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1hdHRuLWltcGwiLCBjaG9pY2VzPVsiYXV0byIsICJlYWdlciIsICJmbGFzaF9hdHRlbnRpb25fMiJdLCBkZWZhdWx0PSJhdXRvIiwgaGVscD0iQXR0ZW50aW9uIGltcGxlbWVudGF0aW9uIGhpbnQgZm9yIEhGIGVuZ2luZSIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW1heC1tb2RlbC1sZW4iLCB0eXBlPWludCwgaGVscD0iT3ZlcnJpZGUgbWF4IG1vZGVsIGxlbmd0aCB3aGVuIHVzaW5nIHZMTE0iKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1ncHUtbWVtb3J5LXV0aWxpemF0aW9uIiwgdHlwZT1mbG9hdCwgZGVmYXVsdD0wLjk1LCBoZWxwPSJGcmFjdGlvbiBvZiBWUkFNIHVzZWQgZm9yIEtWIGNhY2hlICh2TExNKSBvciBMTURlcGxveSBjYWNoZSBidWRnZXQiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1sbWRlcGxveS1tb2RlbC1wYXRoIiwgaGVscD0iUGF0aCB0byBMTURlcGxveSBUdXJib01pbmQgd29ya3NwYWNlIHdoZW4gLS1lbmdpbmUgbG1kZXBsb3kiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1vdXRwdXQtanNvbiIsIGhlbHA9Ik9wdGlvbmFsIHBhdGggdG8gd3JpdGUgSlNPTiByZXN1bHQiKQogICAgYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKCiAgICB0cnk6CiAgICAgICAgcmVzdWx0ID0gcnVuX2JlbmNobWFyaygKICAgICAgICAgICAgbW9kZWxfaWQ9YXJncy5tb2RlbCwKICAgICAgICAgICAgcHJlY2lzaW9uPWFyZ3MucHJlY2lzaW9uLAogICAgICAgICAgICBwcm9tcHRfdG9rZW5zPWFyZ3MucHJvbXB0X3Rva2VucywKICAgICAgICAgICAgZ2VuX3Rva2Vucz1hcmdzLmdlbmVyYXRlZF90b2tlbnMsCiAgICAgICAgICAgIGRldmljZV9tYXA9YXJncy5kZXZpY2VfbWFwLAogICAgICAgICAgICBtYXhfbWVtb3J5X2dpYj1hcmdzLm1heF9tZW1vcnlfZ2liLAogICAgICAgICAgICBvZmZsb2FkX2ZvbGRlcj1hcmdzLm9mZmxvYWRfZm9sZGVyLAogICAgICAgICAgICBvZmZsb2FkX3N0YXRlX2RpY3Q9YXJncy5vZmZsb2FkX3N0YXRlX2RpY3QsCiAgICAgICAgICAgIG9mZmxvYWRfYnVmZmVycz1hcmdzLm9mZmxvYWRfYnVmZmVycywKICAgICAgICAgICAgbG93X2NwdV9tZW1fdXNhZ2U9YXJncy5sb3dfY3B1X21lbV91c2FnZSwKICAgICAgICAgICAgZW5naW5lPWFyZ3MuZW5naW5lLAogICAgICAgICAgICB0ZW5zb3JfcGFyYWxsZWxfc2l6ZT1hcmdzLnRlbnNvcl9wYXJhbGxlbF9zaXplLAogICAgICAgICAgICBhdHRuX2ltcGw9YXJncy5hdHRuX2ltcGwsCiAgICAgICAgICAgIG1heF9tb2RlbF9sZW49YXJncy5tYXhfbW9kZWxfbGVuLAogICAgICAgICAgICBncHVfbWVtb3J5X3V0aWxpemF0aW9uPWFyZ3MuZ3B1X21lbW9yeV91dGlsaXphdGlvbiwKICAgICAgICAgICAgbG1kZXBsb3lfbW9kZWxfcGF0aD1hcmdzLmxtZGVwbG95X21vZGVsX3BhdGgsCiAgICAgICAgKQogICAgICAgIHBheWxvYWQgPSBqc29uLmR1bXBzKHJlc3VsdCwgZW5zdXJlX2FzY2lpPUZhbHNlLCBpbmRlbnQ9MikKICAgICAgICBwcmludChwYXlsb2FkKQogICAgICAgIGlmIGFyZ3Mub3V0cHV0X2pzb246CiAgICAgICAgICAgIHdpdGggb3BlbihhcmdzLm91dHB1dF9qc29uLCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGZwOgogICAgICAgICAgICAgICAgZnAud3JpdGUocGF5bG9hZCArICJcbiIpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGV4YzogICMgc3VyZmFjZSBmYWlsdXJlIGNvbnRleHQKICAgICAgICBlcnJvciA9IHsKICAgICAgICAgICAgIm1vZGVsIjogYXJncy5tb2RlbCwKICAgICAgICAgICAgInByZWNpc2lvbiI6IGFyZ3MucHJlY2lzaW9uLAogICAgICAgICAgICAiZXJyb3IiOiBzdHIoZXhjKSwKICAgICAgICB9CiAgICAgICAgcGF5bG9hZCA9IGpzb24uZHVtcHMgK2Vycm9yLCBlbnN1cmVfYXNjaWk9RmFsc2UsIGluZGVudD0yKQogICAgICAgIHByaW50KHBheWxvYWQpCiAgICAgICAgaWYgYXJncy5vdXRwdXRfanNvbjoKICAgICAgICAgICAgd2l0aCBvcGVuKGFyZ3Mub3V0cHV0X2pzb24sICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZnA6CiAgICAgICAgICAgICAgICBmcC53cml0ZShwYXlsb2FkICsgIlxuIikKICAgICAgICByYWlzZQoKCltpZiBfX25hbWVfXyA9PSAiX19tYWluX18iXToKICAgIG1haW4oKQo="""

Path('/home/azureuser/qwen/qwen_multi_benchmark.py').write_bytes(b64decode(data))
PY
