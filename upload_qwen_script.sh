python3 - <<'PY'
import base64, pathlib
DATA = """IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiJVbmlmaWVkIFF3ZW4gYmVuY2htYXJrIHJ1bm5lciB3aXRoIG9wdGlvbmFsIE5WTWUgb2ZmbG9hZCBoZWxwZXJzLiIiIgoKZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhbm5vdGF0aW9ucwoKaW1wb3J0IGFyZ3BhcnNlCmltcG9ydCBqc29uCmltcG9ydCBtYXRoCmltcG9ydCBvcwppbXBvcnQgdGltZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdCwgT3B0aW9uYWwsIFR1cGxlLCBVbmlvbgoKaW1wb3J0IHRvcmNoCmZyb20gdHJhbnNmb3JtZXJzIGltcG9ydCBBdXRvTW9kZWxGb3JDYXVzYWxMTSwgQXV0b1Rva2VuaXplciAgIyB0eXBlOiBpZ25vcmUKCnRyeTogICMgYml0c2FuZGJ5dGVzIGlzIG9wdGlvbmFsIG91dHNpZGUgSU5UOCBydW5zCiAgICBmcm9tIHRyYW5zZm9ybWVycyBpbXBvcnQgQml0c0FuZEJ5dGVzQ29uZmlnICAjIHR5cGU6IGlnbm9yZQpleGNlcHQgSW1wb3J0RXJyb3I6ICAjIHByYWdtYTogbm8gY292ZXIgLSBkZXBlbmRlbmN5IG9wdGlvbmFsIG9uIEZQMTYtb25seSBob3N0cwogICAgQml0c0FuZEJ5dGVzQ29uZmlnID0gTm9uZQoKdHJ5OiAgIyB2TExNIGlzIG9wdGlvbmFsIGZvciB0ZW5zb3IgcGFyYWxsZWwgcnVucwogICAgZnJvbSB2bGxtIGltcG9ydCBMTE0sIFNhbXBsaW5nUGFyYW1zICAjIHR5cGU6IGlnbm9yZQpleGNlcHQgSW1wb3J0RXJyb3I6ICAjIHByYWdtYTogbm8gY292ZXIgLSB2TExNIG9ubHkgbmVlZGVkIHdoZW4gZW5naW5lPXZsbG0KICAgIExMTSA9IE5vbmUKICAgIFNhbXBsaW5nUGFyYW1zID0gTm9uZQoKQkFTRV9QUk9NUFQgPSAoCiAgICAiVW5pZmllZCBRd2VuIGJlbmNobWFyayBwYXlsb2FkIG1peGluZyBFbmdsaXNoLCDkuK3mlocsIGFuZCBzdHJ1Y3R1cmVkIHN0ZXBzLiAiCiAgICAiV2Ugc3RyZXNzIHRva2VuaXplciB2YXJpZXR5IHdpdGggbWV0cmljcywgQVBJcywgYW5kIGNvbXBsaWFuY2UgdGV4dC4gIgogICAgIuWGjeWkmuWGmeS4gOS6m+maj+acuueahOivjeivreadpeWinuWKoOWkjeadguW6pi4iCikKCgpkZWYgcHJlcGFyZV9wcm9tcHRfdG9rZW5zKHRva2VuaXplcjogQXV0b1Rva2VuaXplciwgdGFyZ2V0X3Rva2VuczogaW50KSAtPiBUdXBsZVt0b3JjaC5UZW5zb3IsIHRvcmNoLlRlbnNvcl06CiAgICBiYXNlX3Rva2VucyA9IHRva2VuaXplcihCQVNFX1BST01QVCwgcmV0dXJuX3RlbnNvcnM9InB0IiwgYWRkX3NwZWNpYWxfdG9rZW5zPUZhbHNlKVsiaW5wdXRfaWRzIl1bMF0KICAgIGlmIGJhc2VfdG9rZW5zLm5lbGVtZW50KCkgPT0gMDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJQcm9tcHQgdG9rZW5pemVyIHJldHVybmVkIHplcm8gdG9rZW5zIikKICAgIHJlcGVhdHMgPSBtYXRoLmNlaWwoKHRhcmdldF90b2tlbnMgKyBsZW4oYmFzZV90b2tlbnMpIC0gMSkgLyBsZW4oYmFzZV90b2tlbnMpKQogICAgZXhwYW5kZWQgPSBiYXNlX3Rva2Vucy5yZXBlYXQocmVwZWF0cylbOnRhcmdldF90b2tlbnNdCiAgICBpbnB1dF9pZHMgPSBleHBhbmRlZC51bnNxdWVlemUoMCkKICAgIGF0dGVudGlvbl9tYXNrID0gdG9yY2gub25lc19saWtlKGlucHV0X2lkcykKICAgIHJldHVybiBpbnB1dF9pZHMsIGF0dGVudGlvbl9tYXNrCgoKZGVmIHN5bmNfY3VkYSgpIC0+IE5vbmU6CiAgICBpZiB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpOgogICAgICAgIHRvcmNoLmN1ZGEuc3luY2hyb25pemUoKQoKCmRlZiBjb2xsZWN0X3BlYWtfbWVtb3J5KCkgLT4gRGljdFtzdHIsIGZsb2F0XToKICAgIHBlYWtzOiBEaWN0W3N0ciwgZmxvYXRdID0ge30KICAgIGlmIHRvcmNoLmN1ZGEuaXNfYXZhaWxhYmxlKCk6CiAgICAgICAgZm9yIGlkeCBpbiByYW5nZSh0b3JjaC5jdWRhLmRldmljZV9jb3VudCgpKToKICAgICAgICAgICAgYnl0ZXNfdXNlZCA9IHRvcmNoLmN1ZGEubWF4X21lbW9yeV9hbGxvY2F0ZWQoaWR4KQogICAgICAgICAgICBwZWFrc1tmImN1ZGE6e2lkeH0iXSA9IHJvdW5kKGJ5dGVzX3VzZWQgLyAoMTAyNCAqKiAzKSwgMikKICAgIHJldHVybiBwZWFrcwoKCmRlZiBidWlsZF9tYXhfbWVtb3J5KGxpbWl0X2dpYjogT3B0aW9uYWxbZmxvYXRdKSAtPiBPcHRpb25hbFtEaWN0W1VuaW9uW2ludCwgc3RyXSwgc3RyXV06CiAgICBpZiBsaW1pdF9naWIgaXMgTm9uZSBvciBub3QgdG9yY2guY3VkYS5pc19hdmFpbGFibGUoKToKICAgICAgICByZXR1cm4gTm9uZQogICAgcGVyX2RldmljZSA9IGYie2xpbWl0X2dpYn1HaUIiCiAgICBsYXlvdXQ6IERpY3RbVW5pb25baW50LCBzdHJdLCBzdHJdID0ge2lkeDogcGVyX2RldmljZSBmb3IgaWR4IGluIHJhbmdlKHRvcmNoLmN1ZGEuZGV2aWNlX2NvdW50KCkpfQogICAgIyBBbHNvIGFkdmVydGlzZSBhIGdlbmVyb3VzIENQVSBidWRnZXQgc28gYWNjZWxlcmF0ZSBoYXMgcm9vbSB0byBzcGlsbCB0ZW5zb3JzLgogICAgbGF5b3V0WyJjcHUiXSA9ICI1MTJHaUIiCiAgICByZXR1cm4gbGF5b3V0CgoKZGVmIHJ1bl9iZW5jaG1hcmsoCiAgICBtb2RlbF9pZDogc3RyLAogICAgcHJlY2lzaW9uOiBzdHIsCiAgICBwcm9tcHRfdG9rZW5zOiBpbnQsCiAgICBnZW5fdG9rZW5zOiBpbnQsCiAgICBkZXZpY2VfbWFwOiBzdHIsCiAgICBtYXhfbWVtb3J5X2dpYjogT3B0aW9uYWxbZmxvYXRdLAogICAgb2ZmbG9hZF9mb2xkZXI6IE9wdGlvbmFsW3N0cl0sCiAgICBvZmZsb2FkX3N0YXRlX2RpY3Q6IGJvb2wsCiAgICBvZmZsb2FkX2J1ZmZlcnM6IGJvb2wsCiAgICBsb3dfY3B1X21lbV91c2FnZTogYm9vbCwKICAgIGVuZ2luZTogc3RyLAogICAgdGVuc29yX3BhcmFsbGVsX3NpemU6IGludCwKICAgIGF0dG5faW1wbDogc3RyLAogICAgbWF4X21vZGVsX2xlbjogT3B0aW9uYWxbaW50XSwKICAgIGdwdV9tZW1vcnlfdXRpbGl6YXRpb246IGZsb2F0LAopIC0+IERpY3Rbc3RyLCBvYmplY3RdOgogICAgdG9rZW5pemVyID0gQXV0b1Rva2VuaXplci5mcm9tX3ByZXRyYWluZWQobW9kZWxfaWQsIHRydXN0X3JlbW90ZV9jb2RlPVRydWUpCiAgICBpZiB0b2tlbml6ZXIucGFkX3Rva2VuIGlzIE5vbmU6CiAgICAgICAgdG9rZW5pemVyLnBhZF90b2tlbiA9IHRva2VuaXplci5lb3NfdG9rZW4KCiAgICBpbnB1dF9pZHMsIGF0dGVudGlvbl9tYXNrID0gcHJlcGFyZV9wcm9tcHRfdG9rZW5zKHRva2VuaXplciwgcHJvbXB0X3Rva2VucykKCiAgICBpZiBlbmdpbmUgPT0gImhmIjoKICAgICAgICBtb2RlbF9rd2FyZ3M6IERpY3Rbc3RyLCBvYmplY3RdID0gewogICAgICAgICAgICAiZGV2aWNlX21hcCI6IGRldmljZV9tYXAsCiAgICAgICAgICAgICJ0cnVzdF9yZW1vdGVfY29kZSI6IFRydWUsCiAgICAgICAgfQoKICAgICAgICBtYXhfbWVtb3J5ID0gYnVpbGRfbWF4X21lbW9yeShtYXhfbWVtb3J5X2dpYikKICAgICAgICBpZiBtYXhfbWVtb3J5OgogICAgICAgICAgICBtb2RlbF9rd2FyZ3NbIm1heF9tZW1vcnkiXSA9IG1heF9tZW1vcnkKCiAgICAgICAgaWYgb2ZmbG9hZF9mb2xkZXI6CiAgICAgICAgICAgIG1vZGVsX2t3YXJnc1sib2ZmbG9hZF9mb2xkZXIiXSA9IG9mZmxvYWRfZm9sZGVyCiAgICAgICAgaWYgb2ZmbG9hZF9zdGF0ZV9kaWN0OgogICAgICAgICAgICBtb2RlbF9rd2FyZ3NbIm9mZmxvYWRfc3RhdGVfZGljdCJdID0gVHJ1ZQogICAgICAgIGlmIG9mZmxvYWRfYnVmZmVyczoKICAgICAgICAgICAgbW9kZWxfa3dhcmdzWyJvZmZsb2FkX2J1ZmZlcnMiXSA9IFRydWUKICAgICAgICBpZiBsb3dfY3B1X21lbV91c2FnZToKICAgICAgICAgICAgbW9kZWxfa3dhcmdzWyJsb3dfY3B1X21lbV91c2FnZSJdID0gVHJ1ZQogICAgICAgIGlmIGF0dG5faW1wbCAhPSAiYXV0byI6CiAgICAgICAgICAgIG1vZGVsX2t3YXJnc1siYXR0bl9pbXBsZW1lbnRhdGlvbiJdID0gYXR0bl9pbXBsCgogICAgICAgIGlmIHByZWNpc2lvbi5sb3dlcigpID09ICJmcDE2IjoKICAgICAgICAgICAgbW9kZWxfa3dhcmdzWyJ0b3JjaF9kdHlwZSJdID0gdG9yY2guZmxvYXQxNgogICAgICAgIGVsaWYgcHJlY2lzaW9uLmxvd2VyKCkgPT0gImludDgiOgogICAgICAgICAgICBpZiBCaXRzQW5kQnl0ZXNDb25maWcgaXMgTm9uZToKICAgICAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiYml0c2FuZGJ5dGVzIGlzIHJlcXVpcmVkIGZvciBJTlQ4IHJ1bnMiKQogICAgICAgICAgICBtb2RlbF9rd2FyZ3NbInF1YW50aXphdGlvbl9jb25maWciXSA9IEJpdHNBbmRCeXRlc0NvbmZpZygKICAgICAgICAgICAgICAgIGxvYWRfaW5fOGJpdD1UcnVlLAogICAgICAgICAgICAgICAgbGxtX2ludDhfdGhyZXNob2xkPTYuMCwKICAgICAgICAgICAgICAgIGxsbV9pbnQ4X2hhc19mcDE2X3dlaWdodD1GYWxzZSwKICAgICAgICAgICAgICAgIGxsbV9pbnQ4X2VuYWJsZV9mcDMyX2NwdV9vZmZsb2FkPUZhbHNlLAogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmIlVuc3VwcG9ydGVkIHByZWNpc2lvbjoge3ByZWNpc2lvbn0iKQoKICAgICAgICBpZiB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpOgogICAgICAgICAgICB0b3JjaC5jdWRhLmVtcHR5X2NhY2hlKCkKICAgICAgICAgICAgdG9yY2guY3VkYS5yZXNldF9wZWFrX21lbW9yeV9zdGF0cygpCgogICAgICAgIG1vZGVsID0gQXV0b01vZGVsRm9yQ2F1c2FsTE0uZnJvbV9wcmV0cmFpbmVkKG1vZGVsX2lkLCAqKm1vZGVsX2t3YXJncykKCiAgICAgICAgaW5wdXRfaWRzX2hmID0gaW5wdXRfaWRzLnRvKG1vZGVsLmRldmljZSkKICAgICAgICBhdHRlbnRpb25fbWFza19oZiA9IGF0dGVudGlvbl9tYXNrLnRvKG1vZGVsLmRldmljZSkKCiAgICAgICAgc3luY19jdWRhKCkKICAgICAgICBzdGFydCA9IHRpbWUucGVyZl9jb3VudGVyKCkKICAgICAgICBvdXRwdXRzID0gbW9kZWwuZ2VuZXJhdGUoCiAgICAgICAgICAgIGlucHV0X2lkcz1pbnB1dF9pZHNfaGYsCiAgICAgICAgICAgIGF0dGVudGlvbl9tYXNrPWF0dGVudGlvbl9tYXNrX2hmLAogICAgICAgICAgICBtYXhfbmV3X3Rva2Vucz1nZW5fdG9rZW5zLAogICAgICAgICAgICB0ZW1wZXJhdHVyZT0wLjcsCiAgICAgICAgICAgIHRvcF9wPTAuOSwKICAgICAgICAgICAgZG9fc2FtcGxlPUZhbHNlLAogICAgICAgICkKICAgICAgICBzeW5jX2N1ZGEoKQogICAgICAgIGVsYXBzZWQgPSB0aW1lLnBlcmZfY291bnRlcigpIC0gc3RhcnQKCiAgICAgICAgdG90YWxfdG9rZW5zID0gb3V0cHV0cy5zaGFwZVstMV0KICAgICAgICBuZXdfdG9rZW5zID0gdG90YWxfdG9rZW5zIC0gcHJvbXB0X3Rva2VucwogICAgICAgIGV4Y2VycHRfdG9rZW5zID0gb3V0cHV0c1swXVstbWluKG5ld190b2tlbnMsIDY0KTpdCiAgICAgICAgZXhjZXJwdF90ZXh0ID0gdG9rZW5pemVyLmRlY29kZShleGNlcnB0X3Rva2Vucywgc2tpcF9zcGVjaWFsX3Rva2Vucz1UcnVlKS5zdHJpcCgpCgogICAgICAgIGRldmljZV9tYXBfb2JqID0gZ2V0YXR0cihtb2RlbCwgImhmX2RldmljZV9tYXAiLCBOb25lKQogICAgICAgIGlmIGlzaW5zdGFuY2UoZGV2aWNlX21hcF9vYmosIGRpY3QpOgogICAgICAgICAgICBkZXZpY2VfbWFwX3NlcmlhbGl6YWJsZSA9IHtrZXk6IHN0cih2YWwpIGZvciBrZXksIHZhbCBpbiBkZXZpY2VfbWFwX29iai5pdGVtcygpfQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRldmljZV9tYXBfc2VyaWFsaXphYmxlID0gTm9uZQoKICAgICAgICBwZWFrX21lbW9yeSA9IGNvbGxlY3RfcGVha19tZW1vcnkoKQogICAgICAgIG1heF9tZW1vcnlfcmVxdWVzdCA9IG1vZGVsX2t3YXJncy5nZXQoIm1heF9tZW1vcnkiKQoKICAgIGVsaWYgZW5naW5lID09ICJ2bGxtIjoKICAgICAgICBpZiBwcmVjaXNpb24ubG93ZXIoKSAhPSAiZnAxNiI6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoInZMTE0gcGF0aCBjdXJyZW50bHkgc3VwcG9ydHMgRlAxNiBvbmx5IGluIHRoaXMgc2NyaXB0IikKICAgICAgICBpZiBMTE0gaXMgTm9uZSBvciBTYW1wbGluZ1BhcmFtcyBpcyBOb25lOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoInZsbG0gcGFja2FnZSBpcyByZXF1aXJlZCB3aGVuIC0tZW5naW5lIHZsbG0iKQoKICAgICAgICBsbG0gPSBMTE0oCiAgICAgICAgICAgIG1vZGVsPW1vZGVsX2lkLAogICAgICAgICAgICB0ZW5zb3JfcGFyYWxsZWxfc2l6ZT10ZW5zb3JfcGFyYWxsZWxfc2l6ZSwKICAgICAgICAgICAgZHR5cGU9ImZsb2F0MTYiLAogICAgICAgICAgICB0cnVzdF9yZW1vdGVfY29kZT1UcnVlLAogICAgICAgICAgICBtYXhfbW9kZWxfbGVuPW1heF9tb2RlbF9sZW4sCiAgICAgICAgICAgIGdwdV9tZW1vcnlfdXRpbGl6YXRpb249Z3B1X21lbW9yeV91dGlsaXphdGlvbiwKICAgICAgICApCgogICAgICAgIHNhbXBsaW5nX3BhcmFtcyA9IFNhbXBsaW5nUGFyYW1zKAogICAgICAgICAgICB0ZW1wZXJhdHVyZT0wLjcsCiAgICAgICAgICAgIHRvcF9wPTAuOSwKICAgICAgICAgICAgbWF4X3Rva2Vucz1nZW5fdG9rZW5zLAogICAgICAgICkKCiAgICAgICAgcHJvbXB0X3Rva2VuX2lkczogTGlzdFtpbnRdID0gaW5wdXRfaWRzWzBdLnRvbGlzdCgpCgogICAgICAgIHN5bmNfY3VkYSgpCiAgICAgICAgc3RhcnQgPSB0aW1lLnBlcmZfY291bnRlcigpCiAgICAgICAgb3V0cHV0cyA9IGxsbS5nZW5lcmF0ZShwcm9tcHRfdG9rZW5faWRzPXByb21wdF90b2tlbl9pZHMsIHNhbXBsaW5nX3BhcmFtcz1zYW1wbGluZ19wYXJhbXMpCiAgICAgICAgc3luY19jdWRhKCkKICAgICAgICBlbGFwc2VkID0gdGltZS5wZXJmX2NvdW50ZXIoKSAtIHN0YXJ0CgogICAgICAgIGlmIG5vdCBvdXRwdXRzOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoInZMTE0gcmV0dXJuZWQgbm8gZ2VuZXJhdGlvbnMiKQoKICAgICAgICBmaXJzdF9vdXRwdXQgPSBvdXRwdXRzWzBdCiAgICAgICAgaWYgbm90IGZpcnN0X291dHB1dC5vdXRwdXRzOgogICAgICAgICAgICByYWlzZSBSdW50aW1lRXJyb3IoInZMTE0gcmVzcG9uc2UgbWlzc2luZyBvdXRwdXQgdG9rZW5zIikKCiAgICAgICAgZ2VuZXJhdGVkID0gZmlyc3Rfb3V0cHV0Lm91dHB1dHNbMF0KICAgICAgICBuZXdfdG9rZW5zID0gbGVuKGdlbmVyYXRlZC50b2tlbl9pZHMpCiAgICAgICAgZXhjZXJwdF90ZXh0ID0gZ2VuZXJhdGVkLnRleHQuc3RyaXAoKQogICAgICAgIGRldmljZV9tYXBfc2VyaWFsaXphYmxlID0gewogICAgICAgICAgICAiZW5naW5lIjogInZsbG0iLAogICAgICAgICAgICAidGVuc29yX3BhcmFsbGVsX3NpemUiOiB0ZW5zb3JfcGFyYWxsZWxfc2l6ZSwKICAgICAgICB9CiAgICAgICAgcGVha19tZW1vcnkgPSBjb2xsZWN0X3BlYWtfbWVtb3J5KCkKICAgICAgICBtYXhfbWVtb3J5X3JlcXVlc3QgPSBOb25lCgogICAgZWxzZToKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiVW5zdXBwb3J0ZWQgZW5naW5lOiB7ZW5naW5lfSIpCgogICAgcmVzdWx0OiBEaWN0W3N0ciwgb2JqZWN0XSA9IHsKICAgICAgICAibW9kZWwiOiBtb2RlbF9pZCwKICAgICAgICAicHJlY2lzaW9uIjogcHJlY2lzaW9uLAogICAgICAgICJwcm9tcHRfdG9rZW5zIjogcHJvbXB0X3Rva2VucywKICAgICAgICAiZ2VuZXJhdGVkX3Rva2VucyI6IG5ld190b2tlbnMsCiAgICAgICAgInJlcXVlc3RlZF9nZW5lcmF0ZWRfdG9rZW5zIjogZ2VuX3Rva2VucywKICAgICAgICAid2FsbF90aW1lX3NlY29uZHMiOiBlbGFwc2VkLAogICAgICAgICJ0b2tlbnNfcGVyX3NlY29uZCI6IG5ld190b2tlbnMgLyBlbGFwc2VkIGlmIGVsYXBzZWQgPiAwIGVsc2UgZmxvYXQoImluZiIpLAogICAgICAgICJleGNlcnB0IjogZXhjZXJwdF90ZXh0LAogICAgICAgICJkZXZpY2VfbWFwIjogZGV2aWNlX21hcF9zZXJpYWxpemFibGUsCiAgICAgICAgInBlYWtfbWVtb3J5X2dpYiI6IHBlYWtfbWVtb3J5LAogICAgICAgICJtYXhfbWVtb3J5X3JlcXVlc3QiOiBtYXhfbWVtb3J5X3JlcXVlc3QsCiAgICAgICAgIm9mZmxvYWRfZm9sZGVyIjogb2ZmbG9hZF9mb2xkZXIsCiAgICAgICAgIm9mZmxvYWRfc3RhdGVfZGljdCI6IG9mZmxvYWRfc3RhdGVfZGljdCwKICAgICAgICAib2ZmbG9hZF9idWZmZXJzIjogb2ZmbG9hZF9idWZmZXJzLAogICAgICAgICJsb3dfY3B1X21lbV91c2FnZSI6IGxvd19jcHVfbWVtX3VzYWdlLAogICAgICAgICJlbmdpbmUiOiBlbmdpbmUsCiAgICAgICAgInRlbnNvcl9wYXJhbGxlbF9zaXplIjogdGVuc29yX3BhcmFsbGVsX3NpemUsCiAgICAgICAgImF0dG5faW1wbGVtZW50YXRpb24iOiBhdHRuX2ltcGwsCiAgICAgICAgIm1heF9tb2RlbF9sZW4iOiBtYXhfbW9kZWxfbGVuLAogICAgICAgICJncHVfbWVtb3J5X3V0aWxpemF0aW9uIjogZ3B1X21lbW9yeV91dGlsaXphdGlvbiwKICAgIH0KICAgIHJldHVybiByZXN1bHQKCgpkZWYgbWFpbigpIC0+IE5vbmU6CiAgICBwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0iUnVuIFF3ZW4gYmVuY2htYXJrIGZvciBhcmJpdHJhcnkgbW9kZWwiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1tb2RlbCIsIHJlcXVpcmVkPVRydWUsIGhlbHA9Ik1vZGVsIElELCBlLmcuLCBRd2VuL1F3ZW4yLjUtMzJCLUluc3RydWN0IikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tcHJlY2lzaW9uIiwgY2hvaWNlcz1bIkZQMTYiLCAiSU5UOCJdLCByZXF1aXJlZD1UcnVlKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1wcm9tcHQtdG9rZW5zIiwgdHlwZT1pbnQsIGRlZmF1bHQ9MTBfMDAwKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1nZW5lcmF0ZWQtdG9rZW5zIiwgdHlwZT1pbnQsIGRlZmF1bHQ9ODAwKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1kZXZpY2UtbWFwIiwgZGVmYXVsdD0iYXV0byIsIGhlbHA9ImRldmljZV9tYXAgcGFzc2VkIHRvIGZyb21fcHJldHJhaW5lZCAoSEYgZW5naW5lKSIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW1heC1tZW1vcnktZ2liIiwgdHlwZT1mbG9hdCwgaGVscD0iT3B0aW9uYWwgcGVyLUdQVSBtZW1vcnkgY2FwIHBhc3NlZCB0byBmcm9tX3ByZXRyYWluZWQiKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1vZmZsb2FkLWZvbGRlciIsIGhlbHA9Ik9wdGlvbmFsIG9mZmxvYWQgZm9sZGVyIHBhdGggKGUuZy4sIE5WTWUgbW91bnQpIikKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoIi0tb2ZmbG9hZC1zdGF0ZS1kaWN0IiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iRW5hYmxlIHN0YXRlIGRpY3Qgb2ZmbG9hZCB0byBDUFUvZGlzayIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW9mZmxvYWQtYnVmZmVycyIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9IkVuYWJsZSBidWZmZXIgb2ZmbG9hZCB0byBDUFUvZGlzayIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWxvdy1jcHUtbWVtLXVzYWdlIiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iQWN0aXZhdGUgbG93X2NwdV9tZW1fdXNhZ2UgZmxhZyIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWVuZ2luZSIsIGNob2ljZXM9WyJoZiIsICJ2bGxtIl0sIGRlZmF1bHQ9ImhmIiwgaGVscD0iUnVudGltZSBlbmdpbmU6IEh1Z2dpbmdGYWNlIG9yIHZMTE0iKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS10ZW5zb3ItcGFyYWxsZWwtc2l6ZSIsIHR5cGU9aW50LCBkZWZhdWx0PTEsIGhlbHA9IlRlbnNvciBwYXJhbGxlbCBkZWdyZWUgZm9yIHZMTE0iKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgKICAgICAgICAiLS1hdHRuLWltcGwiLAogICAgICAgIGNob2ljZXM9WyJhdXRvIiwgImVhZ2VyIiwgImZsYXNoX2F0dGVudGlvbl8yIl0sCiAgICAgICAgZGVmYXVsdD0iYXV0byIsCiAgICAgICAgaGVscD0iQXR0ZW50aW9uIGltcGxlbWVudGF0aW9uIGhpbnQgZm9yIEhGIGVuZ2luZSIsCiAgICApCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW1heC1tb2RlbC1sZW4iLCB0eXBlPWludCwgaGVscD0iT3ZlcnJpZGUgbWF4IG1vZGVsIGxlbmd0aCB3aGVuIHVzaW5nIHZMTE0iKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgKICAgICAgICAiLS1ncHUtbWVtb3J5LXV0aWxpemF0aW9uIiwKICAgICAgICB0eXBlPWZsb2F0LAogICAgICAgIGRlZmF1bHQ9MC45NSwKICAgICAgICBoZWxwPSJGcmFjdGlvbiBvZiBWUkFNIHZMTE0gbWF5IGFsbG9jYXRlIGZvciBLViBjYWNoZSAodkxMTSBlbmdpbmUgb25seSkiLAogICAgKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1vdXRwdXQtanNvbiIsIGhlbHA9Ik9wdGlvbmFsIHBhdGggdG8gd3JpdGUgSlNPTiByZXN1bHQiKQogICAgYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKCiAgICB0cnk6CiAgICAgICAgcmVzdWx0ID0gcnVuX2JlbmNobWFyaygKICAgICAgICAgICAgbW9kZWxfaWQ9YXJncy5tb2RlbCwKICAgICAgICAgICAgcHJlY2lzaW9uPWFyZ3MucHJlY2lzaW9uLAogICAgICAgICAgICBwcm9tcHRfdG9rZW5zPWFyZ3MucHJvbXB0X3Rva2VucywKICAgICAgICAgICAgZ2VuX3Rva2Vucz1hcmdzLmdlbmVyYXRlZF90b2tlbnMsCiAgICAgICAgICAgIGRldmljZV9tYXA9YXJncy5kZXZpY2VfbWFwLAogICAgICAgICAgICBtYXhfbWVtb3J5X2dpYj1hcmdzLm1heF9tZW1vcnlfZ2liLAogICAgICAgICAgICBvZmZsb2FkX2ZvbGRlcj1hcmdzLm9mZmxvYWRfZm9sZGVyLAogICAgICAgICAgICBvZmZsb2FkX3N0YXRlX2RpY3Q9YXJncy5vZmZsb2FkX3N0YXRlX2RpY3QsCiAgICAgICAgICAgIG9mZmxvYWRfYnVmZmVycz1hcmdzLm9mZmxvYWRfYnVmZmVycywKICAgICAgICAgICAgbG93X2NwdV9tZW1fdXNhZ2U9YXJncy5sb3dfY3B1X21lbV91c2FnZSwKICAgICAgICAgICAgZW5naW5lPWFyZ3MuZW5naW5lLAogICAgICAgICAgICB0ZW5zb3JfcGFyYWxsZWxfc2l6ZT1hcmdzLnRlbnNvcl9wYXJhbGxlbF9zaXplLAogICAgICAgICAgICBhdHRuX2ltcGw9YXJncy5hdHRuX2ltcGwsCiAgICAgICAgICAgIG1heF9tb2RlbF9sZW49YXJncy5tYXhfbW9kZWxfbGVuLAogICAgICAgICAgICBncHVfbWVtb3J5X3V0aWxpemF0aW9uPWFyZ3MuZ3B1X21lbW9yeV91dGlsaXphdGlvbiwKICAgICAgICApCiAgICAgICAgcGF5bG9hZCA9IGpzb24uZHVtcHMocmVzdWx0LCBlbnN1cmVfYXNjaWk9RmFsc2UsIGluZGVudD0yKQogICAgICAgIHByaW50KHBheWxvYWQpCiAgICAgICAgaWYgYXJncy5vdXRwdXRfanNvbjoKICAgICAgICAgICAgd2l0aCBvcGVuKGFyZ3Mub3V0cHV0X2pzb24sICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZnA6CiAgICAgICAgICAgICAgICBmcC53cml0ZShwYXlsb2FkICsgIlxuIikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjOiAgIyBzdXJmYWNlIGZhaWx1cmUgY29udGV4dAogICAgICAgIGVycm9yID0gewogICAgICAgICAgICAibW9kZWwiOiBhcmdzLm1vZGVsLAogICAgICAgICAgICAicHJlY2lzaW9uIjogYXJncy5wcmVjaXNpb24sCiAgICAgICAgICAgICJlcnJvciI6IHN0cihleGMpLAogICAgICAgIH0KICAgICAgICBwYXlsb2FkID0ganNvbi5kdW1wcyhlcnJvciwgZW5zdXJlX2FzY2lpPUZhbHNlLCBpbmRlbnQ9MikKICAgICAgICBwcmludChwYXlsb2FkKQogICAgICAgIGlmIGFyZ3Mub3V0cHV0X2pzb246CiAgICAgICAgICAgIHdpdGggb3BlbihhcmdzLm91dHB1dF9qc29uLCAidyIsIGVuY29kaW5nPSJ1dGYtOCIpIGFzIGZwOgogICAgICAgICAgICAgICAgZnAud3JpdGUocGF5bG9hZCArICJcbiIpCiAgICAgICAgcmFpc2UKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg=="""
path = pathlib.Path('/home/azureuser/qwen/qwen_multi_benchmark.py')
path.write_bytes(base64.b64decode(DATA))
path.chmod(0o644)
PY
chown azureuser:azureuser /home/azureuser/qwen/qwen_multi_benchmark.py
